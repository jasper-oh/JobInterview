## DB Study

### DML 종류

- Select 데이터를 조회할 때 사용한다.
- Insert 데이터를 입력할 때 사용한다.
- Update 데이터 내용 변경 할 때 사용한다.
- Delete 데이터 내용 삭제할 때 사용한다.

### DDL 종류

- Create 테이블 생성
- Drop 테이블 삭제
- Alter 테이블 수정
- Truncate 테이블에 있는 모든 데이터 삭제

### SELECT 구문 수행 순서

- From – Where – Group By – Having – Select – Order By

### JOIN ?

조인 – 둘 이상의 테이블을 연결해 데이터를 검색하는 방법, 연결하려면 테이블들이 적어도 하나의 칼럼을 공유하고 있어야 함. 이 공유하고 있는 컬럼을 PK 또는 FK값으로 사용

### JOIN 을 왜 사용 ?

정규화 ( 불필요한 데이터의 정합성을 확보하고, 이상현상 발생을 피하기 위해, 테이블을 분할해서 생성하는 것을 말함 )

### inner join & outer join

> > inner join

```sql

SELECT A.ID , A.ENAME, A.KNAME
FROM A INNER JOIN B
ON A.ID = B.ID;

```

교집합 , 공통적인 부분만 select 됨

> > outer join

```sql

SELECT A.ID , A.ENAME, A.KNAME
FROM A FULL OUTER JOIN B
ON A.ID = B.ID;

```

합집합

@@ 오라클은 outer join 있지만, mysql은 없어서 left 조인 + right 조인

### equal join & non-equal join

> > equal join (동등 조인)

조인 대상이 되는 두 테이블에서 공통적으로 존재하는 컬럼의 값이 일치 되는 행을 연결하여 생성하는 조인 기법

A = B , B = C 일때 A = C 와 같다.

```sql
-- 명시적
SELECT *
FROM A INNER JOIN B
ON A.id = B.id

```

```sql
-- 묵시적
SELECT *
FROM A , B
WHERE A.id = B.id

```

### outer join 종류

### natural join ?

자연조인은 동등 조인과 유사하나 조인 대상 테이블의 모든 column 을 비교하여, 같은 컬럼명을 가진 컬럼으로 조인을 수행. 같은 이름을 가진 컬럼은 한번만 추출

```sql
SELECT *
FROM A NATURAL JOIN B

```

### self join ?

자기 자신과 조인하는 기법, 원하는 정보가 한 테이블에 있을떄 사용. A = B , B = C -> A = C 와 같다.
테이블이 하나일 뿐

```sql

SELECT e.name||'의 사장은'||e1.name'입니다'
FROM user e, user e1
WHERE e.boss = e1.empNo

```

### self join 을 왜 사용 ?

원하는 정보가 한 테이블에 있기 때문에

### Union || Join

공통점은 하나 이상의 테이블의 데이터 결합

데이터가 결합되는 방식에 차이점이 있다.

JOIN -> 새로운 열로 결합 ( 수평 결합 )
두개의 테이블 결합시, 첫 번째 테이블의 데이터는 동일한 행의 두번째 테이블 열과 함께 한 열 세트에 표시

```sql

SELECT a.col1 , a.col2 , b.col2
FROM a
INNER JOIN b
ON a.col1 = b.col1

```

Union -> 새로운 행으로 결합 ( 수직 결합 )
두개의 테이블 결합 된 경우, 첫번째 테이블의 데이터는 한 행 세트에 있고, 두 번째 테이블 데이터는 다른 세트에 위치 / select 컬럼 수는 맞춰서 진행해야 한다.

```sql

SELECT col1 , col2
FROM a
UNION
SELECT col1, col2
FROM b

```

### subQuery ?

하나의 sql 문에 포함되어 있는 또 다른 SQL 문을 말한다.

<< 주의 사항 >>

1. 서브쿼리를 괄호로 감싸 사용
2. 서브 쿼리는 단일행 또는 복수행 비교 연산자와 함께 사용
3. 서브 쿼리에서는 order by 사용 불가

서브쿼리는 위치에 따라 명칭이 다르다. from 절에서 사용하는 inline View , select 문에 사용하는 scala subquery , 일반적으로 where 절에 사용하는 것을 subquery 하고 한다.

또한 HAVING 절 ORDER BY 절 INSERT 문의 VALUES 절 UPDATE 문의 SET 절 에서 사용가능

> > 단일행 서브쿼리 , 다중행 서브쿼리 , 다중 컬럼 서브쿼리 , 연관 서브쿼리 에 대해서 공부

> select 절에서 사용하는 서브 쿼리

```sql
SELECT T1.C1, (SELECT AVG(T2.C1) FROM T2 T2)
FROM T1 T1;
```

> from 절에서 사용하는 서브 쿼리

```sql
SELECT T1.C1, T2.C1, T2.C2
FROM T1 T1,
     (SELECT C1, C2 FROM T2) T2
WHERE T1.C1 = T2.C1;
```

> having 절에서 사용하는 서브 쿼리

```sql
SELECT T1.C1, T2.C1, T2.C2
FROM T1 T1, T2 T2
WHERE T1.C1 = T2.C1
GROUP BY T1.C1, T2.C1, T2.C2
HAVING AVG(T1.C1) < (SELECT AVG(C1)
                     FROM T2 );
```

> update 문의 set 절에서 사용하기

```sql
UPDATE T1 T1
   SET T1.C1 = (SELECT T2.C1 FROM T2 T2 WHERE T2.C1 = T1.C1);
```

> insert 문의 values 절에서 사용하기

```sql

INSERT INTO T1 (C1, C2, C3) SELECT C1, C2, C3 FROM T2;

INSERT INTO T1 (C1, C2, C3) VALUES ((SELECT C1 FROM T2), (SELECT C2 FROM T2), (SELECT C3 FROM T2));
```

### 오라클 사용 객체 종류 ?

오라클의 객체 ?

테이블
sql
데이터 사전 = db 운영에 필요한 정보가 있는 특수 테이블
인덱스 = 데이터 검색 성능의 향상을 위해 테이블 열에 사용하는 객체
뷰 = 가상 테이블, 하나이상의 테이블을 조회하는 select 문을 저장하는 객체
시퀸스 = 특정 규칙에 맞게 연속된 숫자를 생성하는 객체
동의어 = 테이블/ 뷰 / 시퀸스 등 객체 이름 대신 사용할 수 있는 다른 이름을 부여하는 객체

### 제약 조건 이란 ??

데이터의 무결성 ( 데이터베이스의 값과 현실 세계의 값이 일치하는 것) 을 유지하기 위한 데이터 베이스의 보편적인 방법, 테이블의 특정 컬럼에 설정하는 제약

-> 테이블 생성 후에도 제약조건을 적용 및 수정할 수 있음

#### 제약조건의 사용 이유

무결성을 유지 하기 위해서

#### 제약조건의 종류 및 간단한 설명

Primary Key = 테이블 데이터를 고유하게 식별하기 위한 키 / 하나의 테이블에 하나의 기본키 제약만 정의가능
-> 고유키 제약 + not null 제약

Unique Key = 테이블 행 데이터를 고유하게 식별하기 위한 고유키 / null 은 고유키 제약의 대상이 아님

Not null = null 값의 입력을 받을 수 없음 / check 의 일부분으로 이해할 수 있다.

Check = 입력할 수 있는 값의 범위를 제한

Foreign Key = 테이블 간의 관계를 정의하기 위해 기본키를 다른 테이블의 외래키로 복사

#### 테이블에 왜 PK 설정 ?

기본키(Primary Key)는 시스템이 한 테이블에 있는 Row가 다른 Row와 구별되는 무언가를 가져야 하므로 이 역할을 수행할 수 있다. 기본키는 한 Row마다 유일해야 하며 NULL이 될 수 없어야 한다.

#### FK 제약 조건은 무엇, 왜 사용 ?

두 테이블간의 관계를 선언하여 데이터간의 무결성을 보장해주는 역할

외래키 관계를 설정하면 하나의 테이블이 다른 테이블에 의존하는 형태

외래키 테이블에 데이터가 입력될 경우 기준 테이블의 내용을 참조해서 데이터가 입력되기 때문에 만약 기준 테이블에 데이터가 존재하지 않을 경우 값이 반영되지 않게 됨

그리고 외래키 설정시 주의해야 할점은 기준 테이블의 열에 반드시 primary key, unique 제약조건이 설정되어 있어야 한다.

#### 트랜젝션 ?

하나의 논리적 기능을 수행하기 위한 작업의 단위로, DB의 일관된 상태로 변환시키는 기능을 수행한다. 트랜잭션은 전체가 수행되거나 또는 전혀 수행되지 않아야 한다.

#### 트랜젝션 || 쓰레드

프로세스, 쓰레드 , 트랜잭션, 더나아가 뮤텍스, 서비스 등이 헷갈리는 개념.

> 프로세스

프로세스는 컴퓨터에서 연속적으로 실행되고 있는 컴퓨터 프로그램을 말한다.

- 스케줄링의 대상이 되는 작업( task ) 와 거의 같은 의미로 쓰인다.
- 여러 개의 프로세스를 사용하는 것을 멀티 프로세싱이라고 하며, 동시에 여러 프로개램을 띄우는 시분할 방식을
  멀티태스킹 이라고 한다.

> > 프로그램 vs 프로세스

프로그램은 일반적으로 실행코드를 뜻하고, 프로세스는 메모리 상에서 실행되는 작업 단위를 지칭한다.

- 하나의 프로그램을 여러 번 구동하면, 여러개의 프로세스가 메모리 상에서 실행된다.

이것을 방지하는 것이 뮤텍스 ( MUTEX ) 상호배제 ( mutual exclusion ) 이다.

뮤텍스로 지정된 프로그램은 임계구역 문제로 중복 실행을 할 수 없게 되는데 이를 원자적 연산이라고 한다.

> > > 뮤텍스와 세마포어는 튜링의 동치 관계 ... ??? 같이 엮임

> 프로세스의 상태

커널 내에는 준비 큐, 대기 큐, 실행 큐등의 자료 구조등이 있으며, 이것을 이용해서 프로세스의 상태를 관리한다.

> 프로세스의 전이

> > 프로세스 vs 쓰레드

> > > 프로세스

- 컴퓨터에서 연속적으로 실행되고 있는 프로그램
- 메모리에 올라와 실행되고 있는 프로그램의 인스턴스( 독립적인 개체 )
- 운영체제로 부터 시스템 자원을 할당받는 작업의 단위
- 동적인 개념으로 실행된 프로그램을 의미

> > > 쓰레드

- 프로세스 내에서 실행되는 여러 흐름의 단위
- 프로세스의 특정한 수행 경로
- 프로세스가 할당받은 자원을 이용하는 실행의 단위

#### View ? & 사용하는 목적

View = 가상 테이블, 하나이상의 테이블을 조회하는 select 문을 저장하는 객체

장점 .. 사용하는 목적

1. 논리적 데이터 독립성을 제공한다.
2. 동일 데이터에 대해 동시에 여러사용자의 상이한 응용이나 요구를 지원해 준다.
3. 사용자의 데이터관리를 간단하게 해준다.
4. 접근 제어를 통한 자동 보안이 제공된다.

단점

1. 독립적인 인덱스를 가질 수 없다.
2. ALTER VIEW문을 사용할 수 없다. 즉 뷰의 정의를 변경할 수 없다.
3. 뷰로 구성된 내용에 대한 삽입, 삭제, 갱신, 연산에 제약이 따른다.

```sql
-- 뷰 정의문

CREATE VIEW 뷰이름[(속성이름[,속성이름])]AS SELECT문;

--고객 테이블에서 주소가 서울시인 고객들의 성명과 전화번호를 서울고객이라는 뷰로 만들어라--
CREATE VIEW 서울고객(성명, 전화번호)
AS SELECT 성명 전화번호
FROM 고객
WHERE 주소 = '서울시';

```

```sql
-- 뷰 삭제문

DROP VIEW 뷰이름 RESTRICT or CASCADE

--서울고객이라는 뷰를 삭제해라--
DROP VIEW 서울고객 RESTRICT;

```

#### index ? & 장점과 단점 & 종류

자주 사용되는 칼럼에 대해서 따로 생성해 놓은 정렬된 테이블.

하나의 테이블이 객체라면, 인덱스 또한 객체가 생성된 것임.

정렬된 상태이기 때문에 어디부터 스캔할지 정하여 index range scan을 통해 full scan보다 빠르게 데이터에 접근할 수 있음

#### 프로시져란 ? 함수란 ? 패키지란 ?

#### 트리거란 ?
